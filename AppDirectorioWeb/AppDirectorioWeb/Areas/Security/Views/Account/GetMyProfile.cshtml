
@model Models.ViewModels.UserViewModel;
<!-- ====================================
———	MY PROFILE
===================================== -->
<section class="bg-light py-5 height100vh">
    <div class="container">
        <nav class="bg-transparent breadcrumb breadcrumb-2 py-4" aria-label="breadcrumb">
            <h2 class="font-weight-normal mb-4 mb-md-0">Mi Perfil</h2>
           
        </nav>
        <div class="row">
            <div class="col-md-5 col-lg-4">
                <div class="card card-profile">
                    <div class="card-profile-img py-6">
                        @if (!string.IsNullOrEmpty(Model.ProfilePicture))
                        {
                              <img class="rounded-circle " data-src="@Model.ProfilePicture" src="@Model.ProfilePicture" alt="Image"> }
                        else
                        {
                              <img class="rounded-circle " data-src="/img/user/avatar-01.png" src="/img/user/avatar-01.png" alt="Image">
                        }

                    </div>
                    <form enctype="multipart/form-data" id="frmProfilePic" asp-controller="Account" asp-action="UpdateMyPictureProfile" asp-antiforgery="true" method="post" class="px-6">
                        <input type="hidden" asp-for="Id" />
                        <input type="hidden" asp-for="UserName" />
                        <div class="custom-file">
                            <input asp-for="Picture" class="custom-file-input cfi" id="customFileLang" lang="es">
                            <label class="custom-file-label" for="customFileLang">Cambiar foto</label>
                        </div>
                    </form>

                    <hr>

                    <div class="card-body text-center">
                        <p>Tu Plan Actual</p>
                        @*<h3 class="font-weight-normal mb-4">@Model.Subscripcion</h3>*@
                        <h3 class="font-weight-normal mb-4">Gratis</h3>
                        @*@if(!String.IsNullOrEmpty(Model.PlanExpirationDate))
        {*@
                        @*<span class="d-block mb-4">Plan vence: <span class="text-primary" id="current_date">@Model.PlanExpirationDate</span> </span>*@
                        @*<a href="pricing-table.html" class="btn btn-secondary btn-sm mb-3">Change</a>*@
                        @*}*@
                        @if (Model.Role == "Soy Emprendedor")
                        {
                            <p>Código descuento para cursos en Brújula Academy</p>
                            <h4>PROMOEMPBRUJULA2026</h4>
                        }

                    </div>
                </div>

            </div>


            <div class="col-md-7 col-lg-8">


                <form asp-controller="Account" asp-antiforgery="true" method="post">
                    <div class="card">
                        <input type="hidden" asp-for="Id" />
                        <div class="card-body p-6">
                            <h3 class="font-weight-normal mb-4">Acerca de ti</h3>
                            @if (!String.IsNullOrEmpty(ViewBag.Updated))
                            {
                                <span class="text-danger">Datos actualizados!</span>
                            }

                            <div class="row">
                                <div class="form-group col-md-12 mb-4">
                                    <label for="firstNameProfile">Nombre Completo</label>
                                    <input asp-for="FullName" class="form-control" />
                                    <span asp-validation-for="FullName" class="text-danger"></span>
                                </div>

                                <div class="form-group col-md-6 mb-6">
                                    <label for="emailProfile">Email(Usuario)</label>
                                    <input asp-for="Email" class="form-control" readonly/>
                                    <span asp-validation-for="Email" class="text-danger"></span>
                                </div>
                                <div class="form-group col-md-6 mb-6">
                                    <label for="phoneProfile">Telefono</label>
                                    <input asp-for="PhoneNumber" class="form-control" />
                                    <span asp-validation-for="PhoneNumber" class="text-danger"></span>
                                </div>
                                <div class="form-group col-md-6 mb-6">
                                    <input asp-for="NotificationsPromo" type="checkbox">
                                    <label>Recibir mensajes sobre promociones y servicios</label>

                                </div>
                                <div class="form-group col-12 mt-4">
                                    <button formaction="UpdateMyProfile" class="btn btn-primary" type="submit">Actualizar datos</button>
                                </div>
                            </div>

                        </div>
                    </div>

                </form>

                <form asp-controller="Account" asp-antiforgery="true" method="post">
                    <div class="card">
                        <input type="hidden" asp-for="Id" />
                        <div class="card-body p-6">
                            <h3 class="font-weight-normal mb-4">Actualizar Password</h3>
                            @if (!String.IsNullOrEmpty(ViewBag.UpdatedPass))
                            {
                              <span class="text-danger">Tu contraseña ha sido actualizada!</span>
                            }
                            <div class="row">
                                <input type="hidden" asp-for="UserName"/>
                                <div class="form-group col-12">
                                    <label for="currentPassword">Password Actual</label>
                                    <input asp-for="ChangePassword.OldPassword" class="form-control" placeholder="********" autocomplete="current-password">
                                    <span asp-validation-for="ChangePassword.OldPassword" class="text-danger"></span>
                                </div>
                                <div class="form-group col-12">
                                    <label for="newPassword">Nuevo Password</label>
                                    <input asp-for="ChangePassword.NewPassword" class="form-control" placeholder="New Password" autocomplete="new-password">
                                    <span asp-validation-for="ChangePassword.NewPassword" class="text-danger"></span>
                                </div>
                                <div class="form-group col-12">
                                    <label for="confirmPassword">Confirmar Password</label>
                                    <input asp-for="ChangePassword.ConfirmPassword" class="form-control" placeholder="Confirm Password" autocomplete="new-password">
                                    <span asp-validation-for="ChangePassword.ConfirmPassword" class="text-danger"></span>
                                </div>
                                <div class="form-group col-12 mt-4">
                                    <button formaction="ChangePassword" class="btn btn-primary" type="submit">Cambiar Password</button>
                                </div>

                            </div>
                        </div>
                    </div>
                </form>

            </div>
        </div>
    </div>
</section>

@section Scripts{
    <partial name="_ValidationScriptsPartial" />

<script>

    $('.cfi').on("change", function () {


        $("#frmProfilePic").submit();
    });
</script>
    
}